# Image Protocol in FKNB

This document outlines the current approach to handling images within FkNB notebooks. While the functionality is still evolving, this section describes the intended mechanism.

## 1. `lua/fknb/core/bridge/python/image_utils.py` - Image Handling Utilities

Currently, the `image_utils.py` file is a placeholder. Its intended purpose is to provide utility functions for processing and embedding images generated by the kernel within the Neovim environment. This could involve:

*   **Base64 Encoding/Decoding:** Converting image data to and from Base64 strings for transmission between the Python kernel and Neovim.
*   **Image Format Conversion:** Handling different image formats (e.g., PNG, JPEG, SVG) to ensure compatibility with Neovim's rendering capabilities (if any, or for external viewers).
*   **Image Display:** Potentially integrating with external image viewers or Neovim plugins that can render images directly within the terminal or a floating window.

## Current State and Future Plans

As of now, direct inline image rendering within Neovim is a complex feature that requires robust integration with terminal capabilities or external tools. The `image_utils.py` file is a foundational component for future development in this area.

When the kernel produces image output (e.g., Matplotlib plots), the `kernel.py` bridge script will eventually utilize `image_utils.py` to process this image data. The processed data (likely Base64 encoded) would then be sent to Neovim as part of the cell's output.

On the Neovim side, the `ui-rendering.md` described modules would then need to interpret this image data and display it appropriately. This might involve:

*   Detecting image MIME types in the output.
*   Decoding Base64 image data.
*   Using a Neovim plugin (e.g., `nvim-web-devicons` for simple icons, or a more advanced image viewer plugin) to render the image.
*   Alternatively, opening the image in an external viewer.

This protocol is subject to change as image handling capabilities within Neovim and FkNB evolve.
